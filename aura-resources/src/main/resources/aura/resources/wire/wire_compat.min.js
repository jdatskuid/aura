(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.WireService={})})(this,function(a){"use strict";function b(a,b){return null!=b&&"undefined"!=typeof Symbol&&b[Symbol.hasInstance]?b[Symbol.hasInstance](a):a instanceof b}function c(a,b){a.forEach(function(a){var c=a.listener,d=a.statics,e=a.params,f=Object.create(null);if(e)for(var g=Object.keys(e),h=0,i=g.length;h<i;h++){var j=g[h],k=b[e[j]];f[j]=k}var l=Object.assign({},d,f);c.call(void 0,l)})}function d(a,b,c){c.mutated||(c.mutated=new Set,Promise.resolve().then(e.bind(void 0,a,c))),c.mutated.add(b)}function e(a,b){var d=new Set,e=b.mutated;delete b.mutated,e.forEach(function(c){var e=a[c];if(b.values[c]!==e){b.values[c]=e;for(var f=b.listeners[c],g=0,h=f.length;g<h;g++)d.add(f[g])}}),c(d,b.values)}function f(a,b,c){var e=d.bind(void 0,a,b,c),f=h(a,b,e);Object.defineProperty(a,b,f)}function g(a,b,c){if(c=c||[],!a||-1<c.indexOf(a))return null;var d=Object.getOwnPropertyDescriptor(a,b);if(d)return d;var e=Object.getPrototypeOf(a);return e?(c.push(a),g(e,b,c)):null}function h(a,b,c){var d,e,f,h=g(a,b);if(null===h||h.get===void 0&&h.set===void 0){var i=a[b];d=!0,e=function(){return i},f=function(a){i=a,c()}}else{var j=h.set,k=h.get;d=h.enumerable,f=function(b){j&&j.call(a,b),c()},e=function(){return k?k.call(a):void 0}}return{set:f,get:e,enumerable:d,configurable:!0}}function i(a,b){var c=a.indexOf(b);-1<c&&a.splice(c,1)}function j(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c].listener===b)return void a.splice(c,1)}function k(a){for(var b=0,c=a.length;b<c;++b)a[b].call(void 0)}var l={invariant:function(a,b){if(!a)throw new Error("Invariant Violation: "+b)},isTrue:function(a,b){if(!a)throw new Error("Assert Violation: "+b)},isFalse:function(a,b){if(a)throw new Error("Assert Violation: "+b)}},m="@wire",n="updated",o="connected",p="disconnected",q="connect",r="disconnect",s="config",t=function(){function a(a,b,c,d,e){this._cmp=a,this._def=b,this._context=c,this._wireDef=d,this._wireTarget=e}return a.prototype.addEventListener=function(a,b){var c=this;switch(a){case q:var d=this._context[m][o];l.isFalse(d.includes(b),"must not call addEventListener(\"connect\") with the same listener"),d.push(b);break;case r:var e=this._context[m][p];l.isFalse(e.includes(b),"must not call addEventListener(\"disconnect\") with the same listener"),e.push(b);break;case s:var g=this._wireDef.params,h=this._wireDef.static,i=Object.keys(g);if(0===i.length){return void b.call(void 0,h||{})}var j={listener:b,statics:h,params:g},k=this._context[m][n];i.forEach(function(a){var b=g[a],d=k.listeners[b];d?d.push(j):(d=[j],k.listeners[b]=d,f(c._cmp,b,k))});break;default:throw new Error("unsupported event type "+a);}},a.prototype.removeEventListener=function(a,b){switch(a){case q:var c=this._context[m][o];i(c,b);break;case r:var d=this._context[m][p];i(d,b);break;case s:var e=this._context[m][n].listeners,f=this._wireDef.params;f&&Object.keys(f).forEach(function(a){var c=f[a],d=e[c];d&&j(d,b)});break;default:throw new Error("unsupported event type "+a);}},a.prototype.dispatchEvent=function(a){if(b(a,u)){var c=a.value;return this._wireDef.method?this._cmp[this._wireTarget](c):this._cmp[this._wireTarget]=c,!1}if("WireContextEvent"===a.type)return this._cmp.dispatchEvent(a);throw new Error("Invalid event "+a+".")},a}(),u=function(){return function(a){this.type="ValueChangedEvent",this.value=a}}(),v=new Map,w={wiring:function(a,b,c,d){var e=d[m]=Object.create(null);e[o]=[],e[p]=[],e[n]={listeners:{},values:{}};for(var f=c.wire,g=Object.keys(f),h=0,i=g.length;h<i;h++){var j=g[h],k=f[j],l=v.get(k.adapter);if(l){var q=new t(a,c,d,k,j);l({dispatchEvent:q.dispatchEvent.bind(q),addEventListener:q.addEventListener.bind(q),removeEventListener:q.removeEventListener.bind(q)})}}},connected:function(a,b,c,d){var e;c.wire&&(e=d[m][o])&&k(e)},disconnected:function(a,b,c,d){var e;c.wire&&(e=d[m][p])&&k(e)}};a.registerWireService=function(a){a(w)},a.register=function(a,b){l.isTrue(a,"adapter id must be truthy"),l.isTrue("function"==typeof b,"adapter factory must be a callable"),v.set(a,b)},a.ValueChangedEvent=u,Object.defineProperty(a,"__esModule",{value:!0})});
